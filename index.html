<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Three GLB Viewer</title>
  <style>
    html,body{height:100%}
    body{margin:0;overflow:hidden;background:#111;color:#fff;font-family:system-ui}
    #log{position:absolute;top:10px;left:10px;background:rgba(0,0,0,.6);
         padding:8px 10px;border-radius:6px;font-size:12px;max-width:320px;
         max-height:40vh;overflow:auto}
  </style>

  <!-- üëá Map the bare specifier "three" to the CDN ESM build -->
  <script type="importmap">
  {
    "imports": {
      "three": "https://unpkg.com/three@0.160.0/build/three.module.js"
    }
  }
  </script>
</head>
<body>
<div id="log">Init‚Ä¶</div>

<script>
  // show first error on page so it's easy to see what's wrong
  const logDiv=document.getElementById('log');
  const log=m=>{logDiv.innerHTML+='<br>'+m; console.log(m);}
  window.addEventListener('error', e=>log('‚ùå JS Error: '+e.message));
  window.addEventListener('unhandledrejection', e=>log('‚ùå Promise: '+(e.reason?.message||e.reason)));
</script>

<script type="module">
  // Now the examples can import "three" internally and the browser will
  // resolve it via the import map above.
  import * as THREE from 'three';
  import { OrbitControls } from 'https://unpkg.com/three@0.160.0/examples/jsm/controls/OrbitControls.js';
  import { GLTFLoader } from 'https://unpkg.com/three@0.160.0/examples/jsm/loaders/GLTFLoader.js';

  const modelURL = './sun.glb?v=1'; // in repo root next to index.html

  // scene
  const scene = new THREE.Scene();
  scene.background = new THREE.Color(0x111111);

  // camera
  const camera = new THREE.PerspectiveCamera(70, innerWidth/innerHeight, 0.1, 1000);
  camera.position.set(0,1,3);

  // renderer
  const renderer = new THREE.WebGLRenderer({antialias:true});
  if ('outputColorSpace' in renderer) renderer.outputColorSpace = THREE.SRGBColorSpace;
  else renderer.outputEncoding = THREE.sRGBEncoding;
  renderer.setSize(innerWidth, innerHeight);
  document.body.appendChild(renderer.domElement);

  // controls + light
  const controls = new OrbitControls(camera, renderer.domElement);
  controls.enableDamping = true;
  scene.add(new THREE.HemisphereLight(0xffffff, 0x222233, 1));

  // loader
  const loader = new GLTFLoader();
  let model = null;

  log('Loading: '+modelURL);
  loader.load(
    modelURL,
    (gltf)=>{ model=gltf.scene; scene.add(model); log('‚úÖ Loaded'); },
    (xhr)=>{ if (xhr.lengthComputable) log('Progress: '+(xhr.loaded/xhr.total*100).toFixed(1)+'%'); },
    (err)=>{ log('‚ùå Error: '+(err?.message||err)); }
  );

  // resize
  addEventListener('resize', ()=>{
    camera.aspect = innerWidth/innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(innerWidth, innerHeight);
  });

  // loop
  (function animate(){
    requestAnimationFrame(animate);
    if (model) model.rotation.y += 0.005;
    controls.update();
    renderer.render(scene, camera);
  })();

  function log(m){ document.getElementById('log').innerHTML += '<br>'+m; console.log(m); }
</script>
</body>
</html>
